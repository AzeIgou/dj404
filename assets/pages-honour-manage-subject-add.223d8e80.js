import{k as e,m as l,L as a,am as t,o,b as s,a as r,w as u,x as d,Y as n,y as m,t as c,f as i,c as p,g as f,F as v,an as _,B as x,C as y,h as V,Z as b}from"./index.7dddb93e.js";import{_ as g}from"./u-navbar.2247389e.js";import{_ as j}from"./message.vue_vue_type_script_setup_true_lang.167ae55e.js";import{_ as h}from"./u-input.4a92a7e0.js";import{_ as C,a as w}from"./u-form.2758243d.js";import{_ as k,a as U}from"./u-cell-group.3ff6fc80.js";import{_ as T}from"./u-switch.a28c9770.js";import{_ as A}from"./u-picker.e822a654.js";import{_ as F}from"./u-button.7f757efe.js";import{_ as O,d as B}from"./useDebounce.1587bee8.js";import{s as L}from"./index.14235ccc.js";import{g as S}from"./go.59004091.js";import{b as z}from"./subjecet.47c34711.js";import{_ as I}from"./_plugin-vue_export-helper.cdc0426e.js";import"./emitter.9c2dba95.js";import"./u-upload.fc59abfe.js";import"./u-line-progress.c40d9c0e.js";const N=I(e({__name:"add",setup(e){const I=l(!1),N=a(),R=t(),D=l(!1),H=l(!1),Y=l(!1),Z=l(!1),q=l(""),E=l("");let G=l("");const J=l([]);let K=l({isOver:!1,projectName:"",approvalCode:"",startTime:"",executor:"",level:void 0,partyCommitteeCode:"",partyBranchCode:"",source:"",projectCode:"",startFileAddress:[],endFileAddress:[],endTime:"",code:""});const M=e=>{K.value.startFileAddress.push({name:e.split("/")[1],url:e})},P=e=>{K.value.endFileAddress.push({name:e.split("/")[1],url:e})},Q=e=>{K.value.startTime=e.year+"-"+e.month+"-"+e.day},W=e=>{K.value.endTime=e.year+"-"+e.month+"-"+e.day},X=async e=>{q.value=R.committeeList[e[0]].name,K.value.partyCommitteeCode=R.committeeList[e[0]].code,E.value="";let l=await _({code:R.committeeList[e[0]].code});J.value=l},$=e=>{E.value=J.value[e[0]].name,K.value.partyBranchCode=J.value[e[0]].code},ee=e=>{K.value.startFileAddress.splice(e,1)},le=e=>{K.value.endFileAddress.splice(e,1)},ae=e=>{K.value.level=L[e[0]].value,G.value=L[e[0]].type},te=B((async()=>{let e=oe(K.value);console.log(e);for(const[a,t]of Object.entries(K.value))if("partyBranchCode"!==a&&"code"!==a&&"endFileAddress"!==a&&"endTime"!==a&&"startFileAddress"!==a){if(e){await z(K.value);try{N.showTips({title:"新增成功",type:"success"}),setTimeout((()=>{S("/pages/honour-manage/subject/subject"),b("addSubjectSuccess")}),1e3)}catch(l){}break}N.showTips({title:"请将内容填写完整",type:"warning"});break}}),1e3),oe=e=>{for(const[l,a]of Object.entries(e))if("partyBranchCode"!==l&&"code"!==l&&"endFileAddress"!==l&&"endTime"!==l&&"startFileAddress"!==l&&(""===a||Array.isArray(a)&&0===a.length||void 0===a))return!1;return!0};return(e,l)=>{const a=x(y("u-navbar"),g),t=x(y("message"),j),_=x(y("u-input"),h),b=x(y("u-form-item"),C),B=x(y("u-form"),w),S=V,z=x(y("u-cell-item"),k),N=x(y("u-switch"),T),oe=x(y("u-cell-group"),U),se=x(y("u-picker"),A),re=x(y("u-button"),F);return o(),s(v,null,[r(a,{"title-color":"#000","is-back":!0,title:"新增课题",background:{background:"#ffffff"},"border-bottom":!1}),r(t,{navbarHeight:48}),r(S,{class:"container pb-20rpx"},{default:u((()=>[r(B,{clas:"p-4px",model:d(K),"label-width":"200",ref:"uForm","label-align":"center"},{default:u((()=>[r(b,{label:"项目名称"},{default:u((()=>[r(_,{modelValue:d(K).projectName,"onUpdate:modelValue":l[0]||(l[0]=e=>d(K).projectName=e),placeholder:"请输入项目名称"},null,8,["modelValue"])])),_:1}),r(b,{label:"项目负责人"},{default:u((()=>[r(_,{modelValue:d(K).approvalCode,"onUpdate:modelValue":l[1]||(l[1]=e=>d(K).approvalCode=e),placeholder:"请输入项目负责人"},null,8,["modelValue"])])),_:1}),r(b,{label:"项目来源"},{default:u((()=>[r(_,{modelValue:d(K).source,"onUpdate:modelValue":l[2]||(l[2]=e=>d(K).source=e),placeholder:"请输入项目来源"},null,8,["modelValue"])])),_:1}),r(b,{label:"项目批准文号"},{default:u((()=>[r(_,{modelValue:d(K).executor,"onUpdate:modelValue":l[3]||(l[3]=e=>d(K).executor=e),placeholder:"请输入项目批准文号"},null,8,["modelValue"])])),_:1}),r(b,{label:"项目编号"},{default:u((()=>[r(_,{modelValue:d(K).projectCode,"onUpdate:modelValue":l[4]||(l[4]=e=>d(K).projectCode=e),placeholder:"请输入项目编号"},null,8,["modelValue"])])),_:1}),r(b,{label:"二级党委"},{default:u((()=>[r(_,{placeholder:"请选择二级党委",disabled:!0,onClick:l[5]||(l[5]=e=>H.value=!0),modelValue:d(q),"onUpdate:modelValue":l[6]||(l[6]=e=>n(q)?q.value=e:null)},null,8,["modelValue"])])),_:1}),r(b,{label:"党支部"},{default:u((()=>[r(_,{placeholder:"请选择党支部",disabled:!0,onClick:l[7]||(l[7]=e=>Z.value=!0),modelValue:d(E),"onUpdate:modelValue":l[8]||(l[8]=e=>n(E)?E.value=e:null)},null,8,["modelValue"])])),_:1}),r(b,{label:"项目级别"},{default:u((()=>[r(_,{placeholder:"请选择项目级别",disabled:!0,onClick:l[9]||(l[9]=e=>Y.value=!0),modelValue:d(G),"onUpdate:modelValue":l[10]||(l[10]=e=>n(G)?G.value=e:G=e)},null,8,["modelValue"])])),_:1})])),_:1},8,["model"]),r(oe,null,{default:u((()=>[r(z,{arrow:!1},{default:u((()=>[r(S,{slot:"icon",class:"flex items-center"},{default:u((()=>[m("span",null,"发表日期"),r(S,{class:"flex flex-col items-center justify-center my-20rpx"},{default:u((()=>[r(S,{class:"w-350rpx h-50rpx m-20rpx rounded-lg bg--wn-f5f5f5 leading-50rpx text-center mx-20rpx",onClick:l[11]||(l[11]=e=>D.value=!0)},{default:u((()=>[""==d(K).startTime?(o(),s("span",{key:0}," 立项日期 ")):(o(),s("span",{key:1,class:"v-else"},c(d(K).startTime),1))])),_:1})])),_:1})])),_:1})])),_:1}),r(z,{arrow:!1},{default:u((()=>[r(S,{slot:"icon",class:"flex items-center"},{default:u((()=>[r(S,{class:"justify-center w-full"},{default:u((()=>[r(S,{class:"w-224rpx"},{default:u((()=>[i(" 立项支撑材料上传 ")])),_:1}),r(S,{class:"w-700rpx"},{default:u((()=>[r(O,{"file-list":[],onUploadSuccess:M,onImgRemove:ee})])),_:1})])),_:1})])),_:1})])),_:1}),r(z,{arrow:!1,title:"是否结课"},{"right-icon":u((()=>[r(N,{modelValue:d(K).isOver,"onUpdate:modelValue":l[12]||(l[12]=e=>d(K).isOver=e),activeColor:"#B94949"},null,8,["modelValue"])])),_:1}),d(K).isOver?(o(),p(z,{key:0,arrow:!1},{default:u((()=>[r(S,{slot:"icon",class:"flex items-center"},{default:u((()=>[m("span",null,"结课日期"),r(S,{class:"flex flex-col items-center justify-center my-20rpx"},{default:u((()=>[r(S,{class:"w-350rpx h-50rpx m-20rpx rounded-lg bg--wn-f5f5f5 leading-50rpx text-center mx-20rpx",onClick:l[13]||(l[13]=e=>I.value=!0)},{default:u((()=>[""==d(K).endTime?(o(),s("span",{key:0}," 结课日期 ")):(o(),s("span",{key:1,class:"v-else"},c(d(K).endTime),1))])),_:1})])),_:1})])),_:1})])),_:1})):f("v-if",!0),d(K).isOver?(o(),p(z,{key:1,arrow:!1},{default:u((()=>[r(S,{slot:"icon",class:"flex items-center"},{default:u((()=>[r(S,{class:"justify-center w-full"},{default:u((()=>[r(S,{class:"w-224rpx"},{default:u((()=>[i(" 结课支撑材料上传 ")])),_:1}),r(S,{class:"w-700rpx"},{default:u((()=>[r(O,{"file-list":[],onUploadSuccess:P,onImgRemove:le})])),_:1})])),_:1})])),_:1})])),_:1})):f("v-if",!0)])),_:1})])),_:1}),r(se,{modelValue:d(D),"onUpdate:modelValue":l[14]||(l[14]=e=>n(D)?D.value=e:null),mode:"time",params:{year:!0,month:!0,day:!0},onConfirm:Q},null,8,["modelValue"]),r(se,{modelValue:d(I),"onUpdate:modelValue":l[15]||(l[15]=e=>n(I)?I.value=e:null),mode:"time",params:{year:!0,month:!0,day:!0},onConfirm:W},null,8,["modelValue"]),r(se,{mode:"selector",modelValue:d(Y),"onUpdate:modelValue":l[16]||(l[16]=e=>n(Y)?Y.value=e:null),range:d(L),"z-index":"99999999999999",title:"请选择论文级别","default-selector":[0],"range-key":"type",onConfirm:ae},null,8,["modelValue","range"]),r(se,{mode:"selector",modelValue:d(H),"onUpdate:modelValue":l[17]||(l[17]=e=>n(H)?H.value=e:null),range:d(R).committeeList,"z-index":"99999999999999",title:"请选择二级党委","default-selector":[0],"range-key":"name",onConfirm:X},null,8,["modelValue","range"]),r(se,{mode:"selector",modelValue:d(Z),"onUpdate:modelValue":l[18]||(l[18]=e=>n(Z)?Z.value=e:null),range:d(J),"z-index":"99999999999999",title:"请选择党支部","default-selector":[0],"range-key":"name",onConfirm:$},null,8,["modelValue","range"]),r(S,{class:"flex items-center justify-around w-full h-300rpx"},{default:u((()=>[r(re,{class:"w-95-pes-",type:"primary",ripple:!0,onClick:l[19]||(l[19]=e=>d(te)())},{default:u((()=>[i("提交")])),_:1})])),_:1})],64)}}}),[["__scopeId","data-v-f0c9900c"]]);export{N as default};
