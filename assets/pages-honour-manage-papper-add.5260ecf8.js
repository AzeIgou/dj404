import{k as e,L as a,am as l,m as o,o as t,b as r,a as u,w as s,x as d,Y as n,y as m,t as i,f as p,F as c,an as f,B as v,C as _,h as b,Z as g}from"./index.f8f0a8a6.js";import{_ as y}from"./u-navbar.1284843c.js";import{_ as V}from"./message.vue_vue_type_script_setup_true_lang.2049d432.js";import{_ as x}from"./u-input.f5a1625f.js";import{_ as h,a as j}from"./u-form.86e30c0a.js";import{_ as k,a as C}from"./u-cell-group.c1b9a19e.js";import{_ as w}from"./u-picker.4f0ca51a.js";import{_ as U}from"./u-button.9b5620aa.js";import{_ as A,d as T}from"./useDebounce.704380c3.js";import{p as N}from"./index.14235ccc.js";import{g as B}from"./go.241c4b18.js";import{b as L}from"./papper.6dea8f74.js";import{_ as P}from"./_plugin-vue_export-helper.cdc0426e.js";import"./emitter.9c2dba95.js";import"./u-upload.bcce9b3d.js";import"./u-line-progress.aa9a4d7b.js";const z=P(e({__name:"add",setup(e){const P=a(),z=l(),W=o(!1),F=o(!1),I=o(!1),O=o(!1),S=o(""),D=o(""),H=o([]);let R=o({paperName:"",PaperTime:"",mainWriter:"",level:"",journalName:"",partyCommitteeCode:"",partyBranchCode:"",code:"",fileAddress:[]});const Y=e=>{R.value.fileAddress.push({name:e.split("/")[1],url:e})},Z=e=>{R.value.PaperTime=e.year+"-"+e.month+"-"+e.day},q=async e=>{S.value=z.committeeList[e[0]].name,R.value.partyCommitteeCode=z.committeeList[e[0]].code,D.value="";let a=await f({code:z.committeeList[e[0]].code});H.value=a},E=e=>{D.value=H.value[e[0]].name,R.value.partyBranchCode=H.value[e[0]].code},G=e=>{R.value.fileAddress.splice(e,1)},J=e=>{R.value.level=N[e[0]].value},K=T((async()=>{let e=M(R.value);console.log(e);for(const[l,o]of Object.entries(R.value))if("partyBranchCode"!==l&&"code"!==l&&"fileAddress"!==l){if(e){await L(R.value);try{P.showTips({title:"新增成功",type:"success"}),setTimeout((()=>{B("/pages/honour-manage/papper/papper"),g("addPapperSuccess")}),1e3)}catch(a){}break}P.showTips({title:"请将内容填写完整",type:"warning"});break}}),1e3),M=e=>{for(const[a,l]of Object.entries(e))if("partyBranchCode"!==a&&"code"!==a&&"fileAddress"!==a&&(""===l||Array.isArray(l)&&0===l.length||void 0===l))return!1;return!0};return(e,a)=>{const l=v(_("u-navbar"),y),o=v(_("message"),V),f=v(_("u-input"),x),g=v(_("u-form-item"),h),T=v(_("u-form"),j),B=b,L=v(_("u-cell-item"),k),P=v(_("u-cell-group"),C),M=v(_("u-picker"),w),Q=v(_("u-button"),U);return t(),r(c,null,[u(l,{"title-color":"#000","is-back":!0,title:"新增论文",background:{background:"#ffffff"},"border-bottom":!1}),u(o,{navbarHeight:48}),u(B,{class:"container pb-20rpx"},{default:s((()=>[u(T,{clas:"p-4px",model:d(R),"label-width":"200",ref:"uForm","label-align":"center"},{default:s((()=>[u(g,{label:"论文名称"},{default:s((()=>[u(f,{modelValue:d(R).paperName,"onUpdate:modelValue":a[0]||(a[0]=e=>d(R).paperName=e),placeholder:"请输入荣誉名称"},null,8,["modelValue"])])),_:1}),u(g,{label:"第一作者"},{default:s((()=>[u(f,{modelValue:d(R).mainWriter,"onUpdate:modelValue":a[1]||(a[1]=e=>d(R).mainWriter=e),placeholder:"请输入获奖对象"},null,8,["modelValue"])])),_:1}),u(g,{label:"期刊名称"},{default:s((()=>[u(f,{modelValue:d(R).journalName,"onUpdate:modelValue":a[2]||(a[2]=e=>d(R).journalName=e),placeholder:"请输入颁奖单位"},null,8,["modelValue"])])),_:1}),u(g,{label:"二级党委"},{default:s((()=>[u(f,{placeholder:"请选择二级党委",disabled:!0,onClick:a[3]||(a[3]=e=>F.value=!0),modelValue:d(S),"onUpdate:modelValue":a[4]||(a[4]=e=>n(S)?S.value=e:null)},null,8,["modelValue"])])),_:1}),u(g,{label:"党支部"},{default:s((()=>[u(f,{placeholder:"请选择党支部",disabled:!0,onClick:a[5]||(a[5]=e=>O.value=!0),modelValue:d(D),"onUpdate:modelValue":a[6]||(a[6]=e=>n(D)?D.value=e:null)},null,8,["modelValue"])])),_:1}),u(g,{label:"论文级别"},{default:s((()=>[u(f,{placeholder:"请选择论文级别",disabled:!0,onClick:a[7]||(a[7]=e=>I.value=!0),modelValue:d(R).level,"onUpdate:modelValue":a[8]||(a[8]=e=>d(R).level=e)},null,8,["modelValue"])])),_:1})])),_:1},8,["model"]),u(P,null,{default:s((()=>[u(L,{arrow:!1},{default:s((()=>[u(B,{slot:"icon",class:"flex items-center"},{default:s((()=>[m("span",null,"发表日期"),u(B,{class:"flex flex-col items-center justify-center my-20rpx"},{default:s((()=>[u(B,{class:"w-350rpx h-50rpx m-20rpx rounded-lg bg--wn-f5f5f5 leading-50rpx text-center mx-20rpx",onClick:a[9]||(a[9]=e=>W.value=!0)},{default:s((()=>[""==d(R).PaperTime?(t(),r("span",{key:0}," 发表日期 ")):(t(),r("span",{key:1,class:"v-else"},i(d(R).PaperTime),1))])),_:1})])),_:1})])),_:1})])),_:1}),u(L,{arrow:!1},{default:s((()=>[u(B,{slot:"icon",class:"flex items-center"},{default:s((()=>[u(B,{class:"justify-center w-full"},{default:s((()=>[u(B,{class:"w-224rpx"},{default:s((()=>[p(" 支撑材料上传 ")])),_:1}),u(B,{class:"w-700rpx"},{default:s((()=>[u(A,{"file-list":[],onUploadSuccess:Y,onImgRemove:G})])),_:1})])),_:1})])),_:1})])),_:1})])),_:1})])),_:1}),u(M,{modelValue:d(W),"onUpdate:modelValue":a[10]||(a[10]=e=>n(W)?W.value=e:null),mode:"time",params:{year:!0,month:!0,day:!0},onConfirm:Z},null,8,["modelValue"]),u(M,{mode:"selector",modelValue:d(I),"onUpdate:modelValue":a[11]||(a[11]=e=>n(I)?I.value=e:null),range:d(N),"z-index":"99999999999999",title:"请选择论文级别","default-selector":[0],"range-key":"value",onConfirm:J},null,8,["modelValue","range"]),u(M,{mode:"selector",modelValue:d(F),"onUpdate:modelValue":a[12]||(a[12]=e=>n(F)?F.value=e:null),range:d(z).committeeList,"z-index":"99999999999999",title:"请选择二级党委","default-selector":[0],"range-key":"name",onConfirm:q},null,8,["modelValue","range"]),u(M,{mode:"selector",modelValue:d(O),"onUpdate:modelValue":a[13]||(a[13]=e=>n(O)?O.value=e:null),range:d(H),"z-index":"99999999999999",title:"请选择党支部","default-selector":[0],"range-key":"name",onConfirm:E},null,8,["modelValue","range"]),u(B,{class:"flex items-center justify-around w-full h-300rpx"},{default:s((()=>[u(Q,{class:"w-95-pes-",type:"primary",ripple:!0,onClick:a[14]||(a[14]=e=>d(K)())},{default:s((()=>[p("提交")])),_:1})])),_:1})],64)}}}),[["__scopeId","data-v-05ef0ccc"]]);export{z as default};
