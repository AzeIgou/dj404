import{E as t,G as e,W as i,B as s,C as n,o as r,c as a,w as o,a as l,n as h,d as u,b as c,F as d,r as f,f as b,t as g,g as p,aC as m,h as y,K as C,m as x}from"./index.7dddb93e.js";import{_ as S}from"./u-badge.3aac235a.js";import{_ as I}from"./_plugin-vue_export-helper.cdc0426e.js";let w=m;const{windowWidth:v}=t();const W=I({name:"u-tabs-swiper",emits:["update:modelValue","input","change"],props:{isScroll:{type:Boolean,default:!0},list:{type:Array,default:()=>[]},current:{type:[Number,String],default:0},height:{type:[Number,String],default:80},fontSize:{type:[Number,String],default:30},swiperWidth:{type:[String,Number],default:750},activeColor:{type:String,default:"#2979ff"},inactiveColor:{type:String,default:"#303133"},barWidth:{type:[Number,String],default:40},barHeight:{type:[Number,String],default:6},gutter:{type:[Number,String],default:40},zIndex:{type:[Number,String],default:1},bgColor:{type:String,default:"#ffffff"},autoCenterMode:{type:String,default:"window"},name:{type:String,default:"name"},count:{type:String,default:"count"},offset:{type:Array,default:()=>[5,20]},bold:{type:Boolean,default:!0},activeItemStyle:{type:Object,default:()=>({})},showBar:{type:Boolean,default:!0},barStyle:{type:Object,default:()=>({})}},data(){return{scrollLeft:0,tabQueryInfo:[],windowWidth:0,animationFinishCurrent:this.current,componentsWidth:0,line3AddDx:0,line3Dx:0,preId:"UEl_",sW:0,tabsInfo:[],colorGradientArr:[],colorStep:100}},computed:{getCurrent(){const t=Number(this.current);return t>this.getTabs.length-1?this.getTabs.length-1:t<0?0:t},getTabs(){return this.list},scrollBarLeft(){return Number(this.line3Dx)+Number(this.line3AddDx)},barWidthPx(){return e(this.barWidth)},tabItemStyle(){return t=>{let e={height:this.height+"rpx",lineHeight:this.height+"rpx",padding:`0 ${this.gutter/2}rpx`,color:this.tabsInfo.length>0?this.tabsInfo[t]?this.tabsInfo[t].color:this.activeColor:this.inactiveColor,fontSize:this.fontSize+"rpx",zIndex:this.zIndex+2,fontWeight:t==this.getCurrent&&this.bold?"bold":"normal"};return t==this.getCurrent&&(e=Object.assign(e,this.activeItemStyle)),e}},tabBarStyle(){let t={width:this.barWidthPx+"px",height:this.barHeight+"rpx",borderRadius:"100px",backgroundColor:this.activeColor,left:this.scrollBarLeft+"px"};return Object.assign(t,this.barStyle)}},watch:{current(t,e){this.change(t),this.setFinishCurrent(t)},list(){this.$nextTick((()=>{this.init()}))}},mounted(){this.init()},methods:{async init(){this.countPx(),await this.getTabsInfo(),this.countLine3Dx(),this.getQuery((()=>{this.setScrollViewToCenter()})),this.colorGradientArr=w.colorGradient(this.inactiveColor,this.activeColor,this.colorStep)},getTabsInfo(){return new Promise(((t,e)=>{let s=i().in(this);for(let i=0;i<this.list.length;i++)s.select(".UEl_"+i).boundingClientRect();s.exec((e=>{const i=[];for(let t=0;t<e.length;t++)e[t].color=this.inactiveColor,t==this.getCurrent&&(e[t].color=this.activeColor),i.push(e[t]);this.tabsInfo=i,t()}))}))},countLine3Dx(){const t=this.tabsInfo[this.animationFinishCurrent];t&&(this.line3Dx=t.left+t.width/2-this.barWidthPx/2-this.tabsInfo[0].left)},countPx(){this.sW=e(Number(this.swiperWidth))},emit(t){this.$emit("change",t)},change(){this.setScrollViewToCenter()},getQuery(t){try{i().in(this).select(".u-tabs").fields({size:!0},(e=>{e?(this.componentsWidth=e.width,t&&"function"==typeof t&&t(e)):this.getQuery(t)})).exec()}catch(e){this.componentsWidth=v}},setScrollViewToCenter(){let t;if(t=this.tabsInfo[this.animationFinishCurrent],t){let e,i=t.left+t.width/2;e="window"===this.autoCenterMode?v:this.componentsWidth,this.scrollLeft=i-e/2}},setDx(t){let e=t>0?this.animationFinishCurrent+1:this.animationFinishCurrent-1;e=e<=0?0:e,e=e>=this.list.length?this.list.length-1:e,this.tabsInfo[e];let i=this.tabsInfo[this.animationFinishCurrent],s=i.left+i.width/2,n=this.tabsInfo[e],r=n.left+n.width/2,a=Math.abs(r-s);this.line3AddDx=t/this.sW*a,this.setTabColor(this.animationFinishCurrent,e,t)},setTabColor(t,e,i){let s=Math.abs(Math.ceil(i/this.sW*100)),n=this.colorGradientArr.length;s=s>=n?n-1:s<=0?0:s,this.tabsInfo[e].color=this.colorGradientArr[s],this.tabsInfo[t].color=this.colorGradientArr[n-1-s]},setFinishCurrent(t){this.tabsInfo.map(((e,i)=>(e.color=t==i?this.activeColor:this.inactiveColor,e))),this.line3AddDx=0,this.animationFinishCurrent=t,this.countLine3Dx()}}},[["render",function(t,e,i,m,x,I){const w=s(n("u-badge"),S),v=y,W=C;return r(),a(v,{class:"u-tabs",style:h({zIndex:i.zIndex,background:i.bgColor})},{default:o((()=>[l(W,{"scroll-x":"",class:"u-scroll-view","scroll-left":x.scrollLeft,"scroll-with-animation":"",style:h({zIndex:i.zIndex+1})},{default:o((()=>[l(v,{class:u(["u-tabs-scroll-box",{"u-tabs-scroll-flex":!i.isScroll}])},{default:o((()=>[(r(!0),c(d,null,f(I.getTabs,((t,e)=>(r(),a(v,{class:u(["u-tabs-item",[x.preId+e]]),style:h([I.tabItemStyle(e)]),key:e,onClick:t=>I.emit(e)},{default:o((()=>[l(w,{count:t[i.count]||t.count||0,offset:i.offset,size:"mini"},null,8,["count","offset"]),b(" "+g(t[i.name]||t.name),1)])),_:2},1032,["style","class","onClick"])))),128)),i.showBar?(r(),a(v,{key:0,class:"u-scroll-bar",style:h([I.tabBarStyle])},null,8,["style"])):p("v-if",!0)])),_:1},8,["class"])])),_:1},8,["scroll-left","style"])])),_:1},8,["style"])}],["__scopeId","data-v-c10f8967"]]);function F(t,e){const i=x(e&&e.tabCurrent||0),s=x(e&&e.swiperCurrent||0);return{tabCurrent:i,swiperCurrent:s,tabsChange:t=>{s.value=t,e&&e.tabsChange&&e.tabsChange(t)},transition:i=>{let s=i.detail.dx;t.value.setDx(s),e&&e.transition&&e.transition(i)},animationFinish:n=>{let r=n.detail.current;t.value.setFinishCurrent(r),s.value=r,i.value=r,e&&e.animationFinish&&e.animationFinish(n)}}}export{W as _,F as u};
