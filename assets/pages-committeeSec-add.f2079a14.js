import{k as e,L as l,am as a,m as o,o as t,b as u,a as s,w as d,x as r,Y as i,f as n,e as c,F as m,an as f,B as p,C as v,h as _,Z as y}from"./index.7dddb93e.js";import{_ as b}from"./u-navbar.2247389e.js";import{_ as V}from"./message.vue_vue_type_script_setup_true_lang.167ae55e.js";import{_ as g}from"./u-input.4a92a7e0.js";import{_ as h,a as w}from"./u-form.2758243d.js";import{_ as x,a as C}from"./u-cell-group.3ff6fc80.js";import{_ as j}from"./u-button.7f757efe.js";import{_ as k}from"./u-switch.a28c9770.js";import{_ as U}from"./u-picker.e822a654.js";import{_ as F,d as S}from"./useDebounce.1587bee8.js";import{_ as z}from"./index.vue_vue_type_script_setup_true_lang.53873a0c.js";import{d as B,c as L}from"./index.14235ccc.js";import{b as A}from"./index.ef7b58f7.js";import{g as R}from"./go.59004091.js";import{_ as T}from"./_plugin-vue_export-helper.cdc0426e.js";import"./emitter.9c2dba95.js";import"./u-upload.fc59abfe.js";import"./u-line-progress.c40d9c0e.js";const E=T(e({__name:"add",setup(e){const T=l(),E=a(),I=o(""),O=o(""),D=o(!1),H=o(!1),Y=o(!1),Z=o(!1),q=o(""),G=o(""),J=o([]);let K=o(),M=o(),N=o({flowCode:"",code:"",level:void 0,type:void 0,name:"",sort:void 0,des:"",cover:"",videos:[],typicalCases:[],isShow:!0,isSubmit:!0,partyBranchCode:""});const P=async e=>{I.value=E.committeeList[e[0]].name;let l=await f({code:E.committeeList[e[0]].code});J.value=l},Q=e=>{O.value=J.value[e[0]].name,N.value.partyBranchCode=J.value[e[0]].code},W=e=>{N.value.level=e[0],q.value=B[e[0]].type},X=e=>{N.value.type=e[0],G.value=L[e[0]].type},$=e=>{N.value.cover=e,console.log(N.value)},ee=()=>{K.value.uploadFile()},le=()=>{M.value.uploadFile()},ae=e=>{N.value.videos.push({title:e.name,video:e.url})},oe=e=>{N.value.typicalCases.push({title:e.name,content:e.url})},te=S((async()=>{let e=ue(N.value);console.log(e);for(const[a,o]of Object.entries(N.value))if("videos"!==a&&"typicalCases"!==a&&"code"!==a&&"partyBranchCode"!==a&&"flowCode"!==a){if(e){await A(N.value);try{T.showTips({title:"新增成功",type:"success"}),setTimeout((()=>{R("/pages/committeeSec/index"),y("committeeAddSuccess")}),1e3)}catch(l){}break}T.showTips({title:"请将内容填写完整",type:"warning"});break}}),1e3),ue=e=>{for(const[l,a]of Object.entries(e))if("videos"!==l&&"typicalCases"!==l&&"code"!==l&&"partyBranchCode"!==l&&"flowCode"!==l&&(""===a||Array.isArray(a)&&0===a.length||void 0===a))return!1;return!0},se=e=>{N.value.typicalCases.forEach(((l,a)=>{l.title==e.name&&N.value.videos.splice(a,1)}))},de=e=>{N.value.videos.forEach(((l,a)=>{l.title==e.name&&N.value.videos.splice(a,1)}))};return(e,l)=>{const a=p(v("u-navbar"),b),o=p(v("message"),V),f=p(v("u-input"),g),y=p(v("u-form-item"),h),S=p(v("u-form"),w),A=_,R=p(v("u-cell-item"),x),T=p(v("u-button"),j),ue=p(v("u-switch"),k),re=p(v("u-cell-group"),C),ie=p(v("u-picker"),U);return t(),u(m,null,[s(a,{"title-color":"#000","is-back":!0,title:"新增党建双创",background:{background:"#ffffff"},"border-bottom":!1}),s(o,{navbarHeight:48}),s(A,{class:"container pb-20rpx"},{default:d((()=>[s(S,{clas:"p-4px",model:r(N),"label-width":"120",ref:"uForm","label-align":"center"},{default:d((()=>[s(y,{label:"名称"},{default:d((()=>[s(f,{modelValue:r(N).name,"onUpdate:modelValue":l[0]||(l[0]=e=>r(N).name=e),placeholder:"请输入双创名称"},null,8,["modelValue"])])),_:1}),s(y,{label:"排序"},{default:d((()=>[s(f,{modelValue:r(N).sort,"onUpdate:modelValue":l[1]||(l[1]=e=>r(N).sort=e),placeholder:"请输入双创排序"},null,8,["modelValue"])])),_:1}),s(y,{label:"简介"},{default:d((()=>[s(f,{modelValue:r(N).des,"onUpdate:modelValue":l[2]||(l[2]=e=>r(N).des=e),type:"textarea",placeholder:"请输入双创简介"},null,8,["modelValue"])])),_:1}),s(y,{label:"级别"},{default:d((()=>[s(f,{modelValue:r(q),"onUpdate:modelValue":l[3]||(l[3]=e=>i(q)?q.value=e:null),onClick:l[4]||(l[4]=e=>Y.value=!0),disabled:!0,placeholder:"请选择双创级别"},null,8,["modelValue"])])),_:1}),s(y,{label:"类型"},{default:d((()=>[s(f,{modelValue:r(G),"onUpdate:modelValue":l[5]||(l[5]=e=>i(G)?G.value=e:null),onClick:l[6]||(l[6]=e=>Z.value=!0),disabled:!0,placeholder:"请选择双创级别"},null,8,["modelValue"])])),_:1}),s(y,{label:"二级党委"},{default:d((()=>[s(f,{placeholder:"请选择二级党委",disabled:!0,onClick:l[7]||(l[7]=e=>D.value=!0),modelValue:r(I),"onUpdate:modelValue":l[8]||(l[8]=e=>i(I)?I.value=e:null)},null,8,["modelValue"])])),_:1}),s(y,{label:"党支部"},{default:d((()=>[s(f,{placeholder:"请选择党支部",disabled:!0,onClick:l[9]||(l[9]=e=>H.value=!0),modelValue:r(O),"onUpdate:modelValue":l[10]||(l[10]=e=>i(O)?O.value=e:null)},null,8,["modelValue"])])),_:1})])),_:1},8,["model"]),s(re,null,{default:d((()=>[s(R,{arrow:!1},{default:d((()=>[s(A,{slot:"icon",class:"flex items-center"},{default:d((()=>[s(A,{class:"justify-center w-full"},{default:d((()=>[s(A,{class:"w-224rpx"},{default:d((()=>[n(" 双创封面上传 ")])),_:1}),s(A,{class:"w-700rpx"},{default:d((()=>[s(F,{"file-list":[],onUploadSuccess:$,onImgRemove:l[11]||(l[11]=e=>r(N).cover="")})])),_:1})])),_:1})])),_:1})])),_:1}),s(R,{arrow:!1},{default:d((()=>[s(A,{slot:"icon",class:"flex items-center"},{default:d((()=>[s(A,{class:"justify-center w-full"},{default:d((()=>[s(A,{class:"flex justify-between"},{default:d((()=>[s(A,{class:"w-224rpx"},{default:d((()=>[n(" 微视频 ")])),_:1}),s(T,{type:"primary",size:"mini",onClick:c(ee,["self"])},{default:d((()=>[n("上传")])),_:1},8,["onClick"])])),_:1}),s(A,{class:"w-700rpx"},{default:d((()=>[s(z,{ref_key:"fileupload",ref:K,onFileUploadFinsh:ae,onRemoveFile:de},null,512)])),_:1})])),_:1})])),_:1})])),_:1}),s(R,{arrow:!1},{default:d((()=>[s(A,{slot:"icon",class:"flex items-center"},{default:d((()=>[s(A,{class:"justify-center w-full"},{default:d((()=>[s(A,{class:"flex justify-between"},{default:d((()=>[s(A,{class:"w-224rpx"},{default:d((()=>[n(" 典型案例 ")])),_:1}),s(T,{type:"primary",size:"mini",onClick:c(le,["self"])},{default:d((()=>[n("上传")])),_:1},8,["onClick"])])),_:1}),s(A,{class:"w-700rpx"},{default:d((()=>[s(z,{ref_key:"modelfileupload",ref:M,onFileUploadFinsh:oe,onRemoveFile:se},null,512)])),_:1})])),_:1})])),_:1})])),_:1}),s(R,{title:"是否展示",arrow:!1},{"right-icon":d((()=>[s(ue,{modelValue:r(N).isShow,"onUpdate:modelValue":l[12]||(l[12]=e=>r(N).isShow=e),activeColor:"#B94949"},null,8,["modelValue"])])),_:1})])),_:1})])),_:1}),s(ie,{mode:"selector",modelValue:r(D),"onUpdate:modelValue":l[13]||(l[13]=e=>i(D)?D.value=e:null),range:r(E).committeeList,"z-index":"99999999999999",title:"请选择二级党委","default-selector":[0],"range-key":"name",onConfirm:P},null,8,["modelValue","range"]),s(ie,{mode:"selector",modelValue:r(H),"onUpdate:modelValue":l[14]||(l[14]=e=>i(H)?H.value=e:null),range:r(J),"z-index":"99999999999999",title:"请选择党支部","default-selector":[0],"range-key":"name",onConfirm:Q},null,8,["modelValue","range"]),s(ie,{mode:"selector",modelValue:r(Y),"onUpdate:modelValue":l[15]||(l[15]=e=>i(Y)?Y.value=e:null),range:r(B),"z-index":"99999999999999",title:"请选择双创级别","default-selector":[0],"range-key":"type",onConfirm:W},null,8,["modelValue","range"]),s(ie,{mode:"selector",modelValue:r(Z),"onUpdate:modelValue":l[16]||(l[16]=e=>i(Z)?Z.value=e:null),range:r(L),"z-index":"99999999999999",title:"请选择双创类型","default-selector":[0],"range-key":"type",onConfirm:X},null,8,["modelValue","range"]),s(A,{class:"flex items-center justify-around w-full h-300rpx"},{default:d((()=>[s(T,{class:"w-95-pes-",type:"primary",ripple:!0,onClick:l[17]||(l[17]=e=>r(te)())},{default:d((()=>[n("提交")])),_:1})])),_:1})],64)}}}),[["__scopeId","data-v-caf084f9"]]);export{E as default};
