import{k as e,L as a,m as l,q as s,D as t,ac as r,o,b as u,a as c,w as i,x as d,f as m,Y as n,F as p,B as f,C as b,h as _,Z as v}from"./index.f8f0a8a6.js";import{_ as j}from"./u-navbar.1284843c.js";import{_ as g}from"./message.vue_vue_type_script_setup_true_lang.2049d432.js";import{_ as y}from"./u-input.f5a1625f.js";import{_ as h,a as k}from"./u-form.86e30c0a.js";import{_ as w,a as V}from"./u-cell-group.c1b9a19e.js";import{_ as x}from"./u-select.71281130.js";import{_ as U}from"./u-button.9b5620aa.js";import{u as C}from"./meet.474dfb1d.js";import{_ as E,d as G}from"./useDebounce.704380c3.js";import{g as N}from"./go.241c4b18.js";import{a as O,b as S,e as T}from"./index.9462896e.js";import{_ as A}from"./_plugin-vue_export-helper.cdc0426e.js";import"./emitter.9c2dba95.js";import"./u-upload.bcce9b3d.js";import"./u-line-progress.aa9a4d7b.js";const I=A(e({__name:"edit",setup(e){const A=a(),I=C();let D=l([]),F=l([]);const L=l(!1);let P=l({applyGrades:0,pioneerCode:"",title:"",files:[],remark:"",isSubmit:!1,cascader:"",code:""});s((async e=>{if(e&&e.code){const a=await O({code:e.code});P.value.code=e.code,P.value.cascader=a.pioneerParent+"/"+a.pioneerName,a.files.forEach((e=>{F.value.push({url:t.ResourceUrl+e.url})})),Object.keys(a).filter((e=>Object.keys(P.value).includes(e))).reduce(((e,l)=>(e[l]=a[l],e)),P.value)}})),r((()=>{let e=l([]);["履职先锋","为民先锋","引领先锋"].forEach((async a=>{let l=await S({oneNames:a});e.value=e.value.concat(l)})),setTimeout((()=>{D.value=e.value.map((e=>{let a=e.pmPioneerIndexList.map((e=>({label:e.name,value:e.name,grade:e.grades})));return{label:e.oneName,value:e.oneName,children:a}}))}),500)}));const R=e=>{P.value.cascader=e[0].value+"/"+e[1].value,D.value.forEach((a=>{a.value==e[0].value&&a.children.forEach((e=>{P.value.applyGrades=e.grade}))}))},q=G((async e=>{P.value.isSubmit=e;let a=Y(P.value);for(const[s,t]of Object.entries(P.value))if("remark"!==s){if(a){await T(P.value);try{A.showTips({title:"修改成功",type:"success"}),setTimeout((()=>{N("/pages/pm-mangement/user-apply/index"),v("addApplySuccess"),I.$reset()}),1e3)}catch(l){}break}A.showTips({title:"请将内容填写完整",type:"warning"});break}}),1e3),B=e=>{P.value.files.push({name:e.split("/")[1],url:e})},H=e=>{P.value.files.splice(e,1)},Y=e=>{for(const[a,l]of Object.entries(e))if("remark"!==a&&(""===l||Array.isArray(l)&&0===l.length||void 0===l))return!1;return!0};return(e,a)=>{const l=f(b("u-navbar"),j),s=f(b("message"),g),t=f(b("u-input"),y),r=f(b("u-form-item"),h),v=f(b("u-form"),k),C=_,G=f(b("u-cell-item"),w),N=f(b("u-cell-group"),V),O=f(b("u-select"),x),S=f(b("u-button"),U);return o(),u(p,null,[c(l,{"title-color":"#000","is-back":!0,title:"修改申报",background:{background:"#ffffff"},"border-bottom":!1}),c(s,{navbarHeight:48}),c(C,{class:"container pb-20rpx"},{default:i((()=>[c(v,{clas:"p-4px",model:d(P),"label-width":"150",ref:"uForm","label-align":"center"},{default:i((()=>[c(r,{label:"先锋指数"},{default:i((()=>[c(t,{modelValue:d(P).cascader,"onUpdate:modelValue":a[0]||(a[0]=e=>d(P).cascader=e),disabled:!0,placeholder:"请选择先锋指数",onClick:a[1]||(a[1]=e=>L.value=!0)},null,8,["modelValue"])])),_:1}),c(r,{label:"申报标题"},{default:i((()=>[c(t,{modelValue:d(P).title,"onUpdate:modelValue":a[2]||(a[2]=e=>d(P).title=e),placeholder:"请输入申报标题"},null,8,["modelValue"])])),_:1}),c(r,{label:"申报分数"},{default:i((()=>[c(t,{modelValue:d(P).applyGrades,"onUpdate:modelValue":a[3]||(a[3]=e=>d(P).applyGrades=e),disabled:!0},null,8,["modelValue"])])),_:1}),c(r,{label:"申报备注"},{default:i((()=>[c(t,{modelValue:d(P).remark,"onUpdate:modelValue":a[4]||(a[4]=e=>d(P).remark=e),placeholder:"请输入申报备注"},null,8,["modelValue"])])),_:1})])),_:1},8,["model"]),c(N,null,{default:i((()=>[c(G,{arrow:!1},{default:i((()=>[c(C,{slot:"icon",class:"flex items-center"},{default:i((()=>[c(C,{class:"justify-center w-full"},{default:i((()=>[c(C,{class:"w-224rpx"},{default:i((()=>[m(" 申报附件上传 ")])),_:1}),c(C,{class:"w-700rpx"},{default:i((()=>[c(E,{"file-list":d(F),onUploadSuccess:B,onImgRemove:H},null,8,["file-list"])])),_:1})])),_:1})])),_:1})])),_:1})])),_:1}),c(O,{modelValue:d(L),"onUpdate:modelValue":a[5]||(a[5]=e=>n(L)?L.value=e:null),mode:"mutil-column-auto",list:d(D),title:"请选择先锋指数",onConfirm:R},null,8,["modelValue","list"])])),_:1}),c(C,{class:"flex items-center justify-around w-full h-300rpx"},{default:i((()=>[c(S,{class:"w-45-pes-",ripple:!0,onClick:a[6]||(a[6]=e=>d(q)(!1))},{default:i((()=>[m("保存")])),_:1}),c(S,{class:"w-45-pes-",type:"primary",ripple:!0,onClick:a[7]||(a[7]=e=>d(q)(!0))},{default:i((()=>[m("提交")])),_:1})])),_:1})],64)}}}),[["__scopeId","data-v-c2445174"]]);export{I as default};
