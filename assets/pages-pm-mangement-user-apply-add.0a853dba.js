import{k as e,L as a,m as l,ac as s,o as t,b as o,a as r,w as u,x as d,f as i,Y as m,F as n,B as c,C as p,h as f,Z as b}from"./index.7dddb93e.js";import{_}from"./u-navbar.2247389e.js";import{_ as v}from"./message.vue_vue_type_script_setup_true_lang.167ae55e.js";import{_ as g}from"./u-input.4a92a7e0.js";import{_ as j,a as h}from"./u-form.2758243d.js";import{_ as y,a as V}from"./u-cell-group.3ff6fc80.js";import{_ as k}from"./u-select.bbd28a7e.js";import{_ as w}from"./u-button.7f757efe.js";import{u as x}from"./meet.8370cffd.js";import{_ as C,d as U}from"./useDebounce.1587bee8.js";import{g as G}from"./go.59004091.js";import{b as S,r as T}from"./index.2dd11e89.js";import{_ as A}from"./_plugin-vue_export-helper.cdc0426e.js";import"./emitter.9c2dba95.js";import"./u-upload.fc59abfe.js";import"./u-line-progress.c40d9c0e.js";const E=A(e({__name:"add",setup(e){const A=a(),E=x();let I=l([]);const N=l(!1),F=l(!1);let L=l({applyGrades:0,pioneerCode:"",title:"",files:[],remark:"",isSubmit:!1,cascader:""});s((()=>{let e=l([]);["履职先锋","为民先锋","引领先锋"].forEach((async a=>{let l=await S({oneNames:a});e.value=e.value.concat(l)})),setTimeout((()=>{I.value=e.value.map((e=>{let a=e.pmPioneerIndexList.map((e=>({label:e.name,value:e.name,grade:e.grades,code:e.code})));return{label:e.oneName,value:e.oneName,children:a}}))}),500)}));const O=e=>{L.value.cascader=e[0].value+"/"+e[1].value,I.value.forEach((a=>{a.value==e[0].value&&a.children.forEach((a=>{a.value==e[1].value&&(L.value.pioneerCode=a.code,L.value.applyGrades=a.grade)}))}))},B=U((async e=>{L.value.isSubmit=e;let a=P(L.value);for(const[s,t]of Object.entries(L.value))if("remark"!==s){if(a){await T(L.value);try{A.showTips({title:"新增成功",type:"success"}),setTimeout((()=>{G("/pages/pm-mangement/user-apply/index"),b("addApplySuccess"),E.$reset()}),1e3)}catch(l){}break}A.showTips({title:"请将内容填写完整",type:"warning"});break}}),1e3),D=e=>{L.value.files.push({name:e.split("/")[1],url:e})},H=e=>{L.value.files.splice(e,1)},P=e=>{for(const[a,l]of Object.entries(e))if("remark"!==a&&(""===l||Array.isArray(l)&&0===l.length||void 0===l))return!1;return!0};return(e,a)=>{const l=c(p("u-navbar"),_),s=c(p("message"),v),b=c(p("u-input"),g),x=c(p("u-form-item"),j),U=c(p("u-form"),h),G=f,S=c(p("u-cell-item"),y),T=c(p("u-cell-group"),V),A=c(p("u-select"),k),E=c(p("u-button"),w);return t(),o(n,null,[r(l,{"title-color":"#000","is-back":!0,title:"新增申报",background:{background:"#ffffff"},"border-bottom":!1}),r(s,{navbarHeight:48}),r(G,{class:"container pb-20rpx"},{default:u((()=>[r(U,{clas:"p-4px",model:d(L),"label-width":"150",ref:"uForm","label-align":"center"},{default:u((()=>[r(x,{label:"先锋指数"},{default:u((()=>[r(b,{modelValue:d(L).cascader,"onUpdate:modelValue":a[0]||(a[0]=e=>d(L).cascader=e),disabled:!0,placeholder:"请选择先锋指数",onClick:a[1]||(a[1]=e=>N.value=!0)},null,8,["modelValue"])])),_:1}),r(x,{label:"申报标题"},{default:u((()=>[r(b,{modelValue:d(L).title,"onUpdate:modelValue":a[2]||(a[2]=e=>d(L).title=e),placeholder:"请输入申报标题"},null,8,["modelValue"])])),_:1}),r(x,{label:"申报分数"},{default:u((()=>[r(b,{modelValue:d(L).applyGrades,"onUpdate:modelValue":a[3]||(a[3]=e=>d(L).applyGrades=e),disabled:!0,placeholder:"请输入申报标题"},null,8,["modelValue"])])),_:1}),r(x,{label:"申报备注"},{default:u((()=>[r(b,{modelValue:d(L).remark,"onUpdate:modelValue":a[4]||(a[4]=e=>d(L).remark=e),placeholder:"请输入申报标题"},null,8,["modelValue"])])),_:1})])),_:1},8,["model"]),r(T,null,{default:u((()=>[r(S,{arrow:!1},{default:u((()=>[r(G,{slot:"icon",class:"flex items-center"},{default:u((()=>[r(G,{class:"justify-center w-full"},{default:u((()=>[r(G,{class:"w-224rpx"},{default:u((()=>[i(" 申报附件上传 ")])),_:1}),r(G,{class:"w-700rpx"},{default:u((()=>[r(C,{"file-list":[],onUploadSuccess:D,onImgRemove:H})])),_:1})])),_:1})])),_:1})])),_:1})])),_:1}),r(A,{modelValue:d(N),"onUpdate:modelValue":a[5]||(a[5]=e=>m(N)?N.value=e:null),mode:"mutil-column-auto",list:d(I),title:"请选择先锋指数",onConfirm:O},null,8,["modelValue","list"])])),_:1}),r(G,{class:"flex items-center justify-around w-full h-300rpx"},{default:u((()=>[r(E,{class:"w-45-pes-",ripple:!0,loading:d(F),onClick:a[6]||(a[6]=e=>d(B)(!1))},{default:u((()=>[i("保存")])),_:1},8,["loading"]),r(E,{class:"w-45-pes-",type:"primary",ripple:!0,loading:d(F),onClick:a[7]||(a[7]=e=>d(B)(!0))},{default:u((()=>[i("提交")])),_:1},8,["loading"])])),_:1})],64)}}}),[["__scopeId","data-v-f651f4ac"]]);export{E as default};
