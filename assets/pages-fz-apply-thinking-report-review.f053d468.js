import{k as e,T as t,L as a,m as s,M as l,q as o,o as i,b as r,a as u,x as n,w as c,c as p,f as d,t as m,F as f,r as v,g as _,Y as g,Z as h,H as y,B as x,C as w,h as b,D as k,aD as j}from"./index.f8f0a8a6.js";import{_ as C}from"./u-navbar.1284843c.js";import{_ as F,d as V}from"./message.vue_vue_type_script_setup_true_lang.2049d432.js";import{_ as T,a as z}from"./u-cell-group.c1b9a19e.js";import{_ as A}from"./u-image.ae6c79b6.js";import{_ as U}from"./u-tag.2e01dec1.js";import{_ as D}from"./u-input.f5a1625f.js";import{_ as H}from"./u-button.9b5620aa.js";import{b as I,c as L,s as R}from"./thinking-report.646f4819.js";import{w as q}from"./workflow.80bc9344.js";import{w as B}from"./index.14235ccc.js";import"./_plugin-vue_export-helper.cdc0426e.js";import"./emitter.9c2dba95.js";import"./u-line.334abfea.js";const M=e({__name:"review",setup(e){const M=t(),S=a(),Y=s(null),Z=s(null),E=s("思想汇报"),G=l({opinion:"",status:20,trcode:""}),J=["通过","退回修改","不通过"],K=s(!1),N=e=>{switch(G.opinion&&!J.includes(G.opinion)||(G.opinion=J[e-1]),e){case 1:G.status=20;break;case 2:G.status=-20;break;case 3:G.status=-10}K.value=!0},O=async()=>{await L(G),S.showTips({title:"提交成功",type:"success"}),h("refresh"),setTimeout((()=>{y()}),500)},P=async()=>{var e,t;Y.value&&(await R({code:G.trcode,isSave:!0,thinkAddress:null==(e=Y.value)?void 0:e.thinkAddress,username:null==(t=M.userInfo)?void 0:t.username}),S.showTips({title:"提交成功",type:"success"}),setTimeout((()=>y()),500),h("refresh"))};return o((async e=>{e&&e.type&&(Z.value=e.type,"view"==Z.value?E.value="查看思想汇报":"review"==Z.value&&(E.value="审核思想汇报")),e&&e.code&&(Y.value=await I({trCode:e.code}),G.trcode=e.code,console.log(Y.value.status))})),(e,t)=>{const a=x(w("u-navbar"),C),s=x(w("message"),F),l=x(w("u-cell-item"),T),o=x(w("u-image"),A),h=b,y=x(w("u-tag"),U),I=x(w("u-cell-group"),z),L=x(w("u-input"),D),R=x(w("u-button"),H),S=x(w("u-modal"),V);return i(),r(f,null,[u(a,{title:n(E)},null,8,["title"]),u(s,{navbarHeight:48}),u(h,{class:"container"},{default:c((()=>{var e;return[n(Y)?(i(),p(I,{key:0},{default:c((()=>[u(l,{title:"提交日期","hover-class":"none",arrow:!1},{"right-icon":c((()=>[d(m(n(Y).createtime),1)])),_:1}),u(l,{title:"思想汇报","hover-class":"none",arrow:!1},{"right-icon":c((()=>[])),label:c((()=>[u(h,{class:"flex gap-5 justify-center mt-2"},{default:c((()=>[(i(!0),r(f,null,v(n(Y).thinkAddress,((e,t)=>(i(),p(o,{key:t,width:"175rpx",height:"175rpx",src:n(k).ResourceUrl+e,mode:"widthFix",onClick:e=>n(j)(n(Y).thinkAddress,t)},null,8,["src","onClick"])))),128))])),_:1})])),_:1}),u(l,{title:"审核状态","hover-class":"none",arrow:!1},{label:c((()=>{var e;return[0!=n(Y).status?(i(),p(q,{key:0,approve:n(Y).fzFlowList,createtime:n(Y).createtime,creater:null==(e=n(M).userInfo)?void 0:e.realname},null,8,["approve","createtime","creater"])):_("v-if",!0)]})),"right-icon":c((()=>[0==n(Y).status?(i(),p(y,{key:0,class:"absolute top-0 right-30 translate-y-1-sl-2",text:n(B)[n(Y).status].description,type:n(B)[n(Y).status].type,mode:"light"},null,8,["text","type"])):_("v-if",!0)])),_:1})])),_:1})):_("v-if",!0),"review"==n(Z)&&n(Y)&&![20,-10].includes(null==(e=n(Y))?void 0:e.status)?(i(),p(h,{key:1,class:"p-4 flex flex-col gap-3"},{default:c((()=>[u(h,null,{default:c((()=>[d("审批意见")])),_:1}),u(h,{class:"px-4"},{default:c((()=>[u(L,{height:"200","custom-style":{backgroundColor:"#F6F6F6",borderRadius:"20rpx",padding:"20rpx"},modelValue:n(G).opinion,"onUpdate:modelValue":t[0]||(t[0]=e=>n(G).opinion=e),type:"textarea","auto-height":"",class:"auto-height"},null,8,["modelValue"])])),_:1}),u(h,{class:"flex justify-evenly"},{default:c((()=>[u(R,{onClick:t[1]||(t[1]=e=>N(1)),size:"mini","custom-style":{padding:"0 30rpx"},type:"primary"},{default:c((()=>[d("通过")])),_:1}),u(R,{onClick:t[2]||(t[2]=e=>N(2)),size:"mini","custom-style":{padding:"0 30rpx"},type:"warning"},{default:c((()=>[d("退回修改")])),_:1}),u(R,{onClick:t[3]||(t[3]=e=>N(3)),size:"mini","custom-style":{padding:"0 30rpx"},type:"error"},{default:c((()=>[d("不通过")])),_:1})])),_:1})])),_:1})):_("v-if",!0)]})),_:1}),"view"==n(Z)&&n(Y)&&0==n(Y).status?(i(),p(h,{key:0,class:"fixed flex justify-between gap-5 bottom-0 p-5 w-full bg-white rounded-t-lg",style:{"box-shadow":"0px 2px 15px 0px rgba(184, 184, 210, 0.5)"}},{default:c((()=>[u(R,{class:"flex-1",type:"primary",onClick:P},{default:c((()=>[d("提交")])),_:1})])),_:1})):_("v-if",!0),u(S,{modelValue:n(K),"onUpdate:modelValue":t[4]||(t[4]=e=>g(K)?K.value=e:null),title:"是否提交审批","show-cancel-button":"",onConfirm:O,class:"show-cancel-button"},{default:c((()=>[u(h,{class:"p-5 text-center text-sm"},{default:c((()=>[u(h,null,{default:c((()=>[d(" 审批状态："+m(n(B)[n(G).status].description),1)])),_:1}),u(h,null,{default:c((()=>[d(" 审批意见："+m(n(G).opinion),1)])),_:1})])),_:1})])),_:1},8,["modelValue"])],64)}}});export{M as default};
