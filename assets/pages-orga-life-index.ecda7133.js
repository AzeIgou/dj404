import{k as e,E as a,M as l,a0 as t,p as o,o as s,b as n,a as u,w as r,n as d,x as m,f as p,F as c,r as i,Y as f,ar as y,h as _,B as h,C as b,c as g,g as v,L as x,a1 as k,am as j,m as C,a2 as V,a4 as w,t as D,J as U}from"./index.7dddb93e.js";import{_ as S}from"./u-navbar.2247389e.js";import{c as Y,_ as B}from"./message.vue_vue_type_script_setup_true_lang.167ae55e.js";import{_ as M}from"./u-search.1cfa0f81.js";import{_ as F}from"./u-input.4a92a7e0.js";import{_ as z}from"./u-tag.00b1459e.js";import{_ as P}from"./u-button.7f757efe.js";import{_ as T}from"./pagination.vue_vue_type_script_setup_true_lang.3e227710.js";import{_ as E}from"./u-select.bbd28a7e.js";import{g as $}from"./go.59004091.js";import{g as H,r as I}from"./index.04d21dbe.js";import{m as L,e as R,w as q}from"./index.14235ccc.js";import{_ as J,a as W}from"./u-form.2758243d.js";import{_ as A}from"./u-calendar.4c7fa535.js";import{d as G}from"./dayjs.min.4485b413.js";import{_ as K}from"./_plugin-vue_export-helper.cdc0426e.js";import"./emitter.9c2dba95.js";import"./u-loadmore.c9a600cb.js";import"./u-line.65c408c3.js";const N=e({__name:"filter",props:{modelValue:{type:Boolean},schemas:null},emits:["update:modelValue","confirm"],setup(e,{emit:x}){const k=e,j=a().statusBarHeight||0,C=l({});t((()=>{k.schemas.forEach((async(e,a)=>{if("Select"==e.component||"DatePicker"==e.component?C[e.name]={label:"",value:null,show:!1}:C[e.name]="",e.fetcher){const a=await e.fetcher.api();e.props||(e.props={}),e.props[e.fetcher.key]=a}e.defaultShow&&(C[e.name].show=!0)}))}));const V=o({get:()=>k.modelValue,set(e){x("update:modelValue",e)}}),w=()=>{const e={};for(const a in C){const l=C[a];e[a]="object"==typeof l?y(l.value):l}x("confirm",e),V.value=!1},D=()=>{for(const e in C){const a=C[e];"string"==typeof a?C[e]="":"object"==typeof a&&(a.label="",a.value=null)}};return(e,a)=>{const l=_,t=h(b("u-input"),F),o=h(b("u-form-item"),J),y=h(b("u-form"),W),x=h(b("u-button"),P),U=h(b("u-popup"),Y),S=h(b("u-select"),E),B=h(b("u-calendar"),A);return s(),n(c,null,[u(U,{modelValue:m(V),"onUpdate:modelValue":a[0]||(a[0]=e=>f(V)?V.value=e:null),mode:"top","border-radius":"14"},{default:r((()=>[u(l,{class:"flex flex-col h-full p-3",style:d({paddingTop:m(j)+"px"})},{default:r((()=>[u(l,{class:"mx-auto leading-48px"},{default:r((()=>[p("筛选")])),_:1}),u(y,{model:m(C),ref:"uForm","label-width":"150"},{default:r((()=>[(s(!0),n(c,null,i(k.schemas,((e,a)=>(s(),g(o,{label:e.label,key:e.name},{default:r((()=>[v(" 选择器 "),!m(C)[e.name]||"Select"!=e.component&&"DatePicker"!=e.component?null!=m(C)[e.name]&&"Input"==e.component?(s(),n(c,{key:1},[v(" 输入框 "),u(t,{type:"input",modelValue:m(C)[e.name],"onUpdate:modelValue":a=>m(C)[e.name]=a,placeholder:e.placeholder},null,8,["modelValue","onUpdate:modelValue","placeholder"])],2112)):v("v-if",!0):(s(),g(t,{key:0,type:"select",modelValue:m(C)[e.name].label,"onUpdate:modelValue":a=>m(C)[e.name].label=a,placeholder:e.placeholder,onClick:a=>m(C)[e.name].show=!0},null,8,["modelValue","onUpdate:modelValue","placeholder","onClick"]))])),_:2},1032,["label"])))),128))])),_:1},8,["model"]),u(l,{class:"flex gap-3 mt-auto mt-3"},{default:r((()=>[u(x,{class:"flex-1",type:"error",onClick:D},{default:r((()=>[p("重置")])),_:1}),u(x,{class:"flex-1",type:"primary",onClick:w},{default:r((()=>[p("确定")])),_:1})])),_:1})])),_:1},8,["style"])])),_:1},8,["modelValue"]),(s(!0),n(c,null,i(k.schemas,((e,a)=>(s(),g(l,{key:e.name},{default:r((()=>{var a,l,t;return[v(" 普通选择器 "),m(C)[e.name]&&"Select"==e.component?(s(),g(S,{key:0,modelValue:m(C)[e.name].show,"onUpdate:modelValue":a=>m(C)[e.name].show=a,mode:null==(a=e.props)?void 0:a.mode,list:null==(l=e.props)?void 0:l.list,onConfirm:a=>{return l=e.name,t=a,C[l].label=t.map((e=>e.label)).join("-"),void(C[l].value=t);var l,t}},null,8,["modelValue","onUpdate:modelValue","mode","list","onConfirm"])):m(C)[e.name]&&"DatePicker"==e.component?(s(),n(c,{key:1},[v(" 日期选择器 "),u(B,{modelValue:m(C)[e.name].show,"onUpdate:modelValue":a=>m(C)[e.name].show=a,mode:null==(t=e.props)?void 0:t.mode,"min-date":m(G)().subtract(10,"year").format("YYYY-MM-DD"),"max-date":m(G)().add(10,"year").format("YYYY-MM-DD"),onChange:a=>((e,a)=>{e.props&&"range"==e.props.mode?(C[e.name].label=a.startDate+" - "+a.endDate,C[e.name].value=a):(C[e.name].label=a.result,C[e.name].value=a)})(e,a)},null,8,["modelValue","onUpdate:modelValue","mode","min-date","max-date","onChange"])],2112)):v("v-if",!0)]})),_:2},1024)))),128))],64)}}}),O=K(e({__name:"index",setup(e){w((e=>({"53c71487":m(t)})));const a=x(),{statusBarHeight:t}=k(),o=j(),d=C(!1),y=C(),Y=C(!1),J=C(""),W=l({isSaveType:0,startDate:void 0,endDate:void 0,type:void 0,status:void 0,partyCommitteeCode:"",partyBranchCode:""}),A=[{name:"type",label:"会议类型",component:"Select",placeholder:"请选择会议类型",props:{list:L.map((e=>({...e,label:e.type})))}},{name:"status",label:"会议状态",component:"Select",placeholder:"请选择会议状态",props:{list:R.map((e=>({...e,label:e.type})))}},{name:"date",label:"会议日期",component:"DatePicker",placeholder:"请选择会议日期",props:{mode:"range"}}],G=e=>{for(const a in e){const l=e[a];"type"==a||"status"==a?W[a]=l?l[0].value:l:"date"==a&&(W.startDate=l?l.startDate:l,W.endDate=l?l.endDate:l)}},K=async e=>{console.log(e)},O=()=>{y.value.reload()},Q=e=>{W.partyCommitteeCode=e[0].value,W.partyBranchCode=e[1].value,J.value=e.map((e=>e.label)).join("-")};return V("addSubjectSuccess",O),(e,l)=>{const t=h(b("u-navbar"),S),x=h(b("message"),B),k=h(b("u-search"),M),j=_,C=h(b("u-input"),F),V=U,w=h(b("u-tag"),z),R=h(b("u-button"),P),X=h(b("pagination"),T),Z=h(b("u-select"),E);return s(),n(c,null,[u(t,{"title-color":"#FFF","is-back":!0,title:"组织生活",background:{background:"#E35959"},"border-bottom":!1,placeholder:!0,"back-icon-color":"#fff"}),u(x),u(j,{class:"container"},{default:r((()=>[u(j,{class:"px-2 pb-2 pt-1 bg--do-dj-themed-color flex"},{default:r((()=>[u(k,{class:"flex-1",placeholder:"搜索会议名称",shape:"square","action-style":{color:"#ffffff"},actionText:"筛选",onBlur:K,onCustom:l[0]||(l[0]=e=>d.value=!0)})])),_:1}),u(j,null,{default:r((()=>[u(C,{type:"select","input-align":"center","bg-color":"rgb(245, 247, 251)",placeholder:"请选择党组织信息","model-value":m(J),"custom-style":{fontWeight:"bold"},onClick:l[1]||(l[1]=e=>Y.value=!0)},null,8,["model-value"])])),_:1}),u(X,{ref_key:"paginationRef",ref:y,api:m(H),params:m(W),option:{resultField:"meetingList",pageSize:20},class:"h-0 flex-1"},{default:r((e=>[(s(!0),n(c,null,i(e.data,((e,l)=>(s(),g(j,{class:"flex p-4 bg-white m-4 rounded-20rpx",key:e.id,onClick:a=>m($)(`/pages/orga-life/detail?code=${e.id}`)},{default:r((()=>[u(j,{class:"w-full flex flex-col gap-1"},{default:r((()=>[u(j,{class:"flex justify-between w-full"},{default:r((()=>[u(V,{class:"font-bold text-34rpx"},{default:r((()=>[p(D(e.title),1)])),_:2},1024),u(w,{class:"flex-shrink-0",text:m(q)[e.status].description,type:m(q)[e.status].type},null,8,["text","type"])])),_:2},1024),u(j,null,{default:r((()=>[p(" 类型："+D(m(L)[e.type]&&m(L)[e.type].type),1)])),_:2},1024),u(j,null,{default:r((()=>[p(" 日期："+D(e.startDate),1)])),_:2},1024),u(j,null,{default:r((()=>[p(" 参会率："+D(e.attendancRate)+"% ",1)])),_:2},1024),u(j,{class:"flex justify-end gap-3"},{default:r((()=>[0==e.status?(s(),g(R,{key:0,size:"mini",shape:"circle","custom-style":{padding:"0 30rpx"},onClick:a=>m($)(`/pages/orga-life/editMeet?code=${e.id}`)},{default:r((()=>[p(" 修改 ")])),_:2},1032,["onClick"])):v("v-if",!0),"-10"==e.status||0==e.status?(s(),g(R,{key:1,size:"mini",shape:"circle","custom-style":{padding:"0 30rpx"},onClick:l=>(async e=>{await a.confirm({content:"确定删除这条数据吗？"}),await I({code:e}),a.showTips({title:"删除成功",type:"success"}),O()})(e.id)},{default:r((()=>[p(" 删除 ")])),_:2},1032,["onClick"])):v("v-if",!0),10==e.status?(s(),g(R,{key:2,size:"mini",shape:"circle","custom-style":{padding:"0 30rpx"},onClick:a=>m($)(`/pages/orga-life/detail?code=${e.id}`)},{default:r((()=>[p(" 审批 ")])),_:2},1032,["onClick"])):v("v-if",!0)])),_:2},1024)])),_:2},1024)])),_:2},1032,["onClick"])))),128))])),_:1},8,["api","params"]),u(j,{class:"w-full h-150rpx fixed bottom-0 z-999 flex justify-center items-center opacity-100"},{default:r((()=>[u(R,{type:"primary","hover-class":"none",shape:"circle",class:"w-50-pes-",onClick:l[2]||(l[2]=e=>m($)("/pages/orga-life/addMeet")),"custom-style":{background:"#e35959"}},{default:r((()=>[p("新增")])),_:1})])),_:1})])),_:1}),u(N,{modelValue:m(d),"onUpdate:modelValue":l[3]||(l[3]=e=>f(d)?d.value=e:null),schemas:A,onConfirm:G},null,8,["modelValue"]),u(Z,{modelValue:m(Y),"onUpdate:modelValue":l[4]||(l[4]=e=>f(Y)?Y.value=e:null),mode:"mutil-column-auto",list:m(o).getPartyBranchCascader,onConfirm:Q},null,8,["modelValue","list"])],64)}}}),[["__scopeId","data-v-52c3dacd"]]);export{O as default};
